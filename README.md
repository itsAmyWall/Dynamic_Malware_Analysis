# Malware Analysis Lab: Isolated Environment for Static and Dynamic Analysis

This project focuses on building a secure and isolated malware analysis lab capable of both static and dynamic analysis. The lab is designed to compartmentalize and safely detonate malware samples without risk to the host machine or external networks.

## Overview

The lab utilizes:

- **Windows 10 Virtual Machine (VM)** with FLARE VM for static and dynamic analysis tools.
- **REMnux** Linux distribution configured as a Command and Control (C2) server.
- A completely isolated network using VirtualBox’s Host-Only Adapter to ensure no internet connectivity.

### Key Features:
- **Static Analysis Tools**: Examine malware binaries without executing them to identify file structures, dependencies, and potential behavior.
- **Dynamic Analysis Tools**: Monitor malware in real-time to study its runtime behavior in a controlled environment.

## Lab Setup

### Step 1: VirtualBox and Network Configuration

Create a Host-Only Adapter in VirtualBox:

- Set **IPv4 Address** to `10.0.0.1`.
- Configure DHCP Server with the following settings:
  - **Server Address**: `10.0.0.2`
  - **Server Mask**: `255.255.255.0`
  - **Lower Bound**: `10.0.0.3`
  - **Upper Bound**: `10.0.0.254`

Attach the Host-Only Adapter to both the Windows 10 VM and the REMnux VM.

### Step 2: Windows 10 Virtual Machine

1. Disable **Windows Defender** and **Firewall** to avoid interference.
2. Create a **Snapshot** to allow for rollbacks in case of issues.
3. Install FLARE VM:
   - Download the installer (link provided in FLARE VM GitHub).
   - Unblock the file, change the execution policy, and run the installer.
     
     ![unnamed](https://github.com/user-attachments/assets/971622eb-dcca-489c-b369-8a50e5638cee)

   - FLARE VM will take some time to install. Once completed, the VM’s background will change, indicating a successful setup.
     
     ![unnamed](https://github.com/user-attachments/assets/c8d9b92a-0288-4f23-9b8b-792080596bad)

### Step 3: REMnux C2 Server Setup

1. Import the REMnux appliance into VirtualBox and start the VM.
2. Configure REMnux as a DNS Server:
   - Edit `inet_sim.conf` and uncomment `START_SERVICE_DNS`.
   - Set `SERVICES_BIND_ADDRESS` to `0.0.0.0`.
   - Set `DNS_DEFAULT_IP` to `10.0.0.4`.
3. Test connectivity between the Windows VM and REMnux using ping commands to confirm proper network setup.

   ![unnamed](https://github.com/user-attachments/assets/d470cc78-e219-4be0-875e-130de858057a)
   ![unnamed](https://github.com/user-attachments/assets/eeb66c7a-4785-471b-82d7-f9b478ac4e74)

## Tools Included

### Static Analysis Tools
- **VirusTotal**: An online service that aggregates antivirus scan results from multiple vendors. Useful for initial assessments of unknown files by providing hash lookups and reports on potential malicious behavior.
- **Capa**: Detects capabilities in executable files.
- **PE Studio**: Analyzes malware statically without executing it.
- **FLOSS (FireEye Labs Obfuscated String Solver)**: Extracts and deobfuscates strings from executables for further analysis.

### Dynamic Analysis Tools
- **Cutter**: Reverse-engineers programs to view assembly-level instructions.
- **ProcMon**: Tracks system-level events such as file system, registry, and network activity in real time. Useful for observing changes made by malware during execution.
- **Wireshark**: Captures and analyzes network packets to detect malicious communication.
- **YARA**: A rule-based engine for identifying and classifying malware samples.

## Network Topology

The setup includes two VMs on a host-only network:

- **Windows 10 VM** with FLARE VM installed.
- **REMnux C2 server** acting as the DNS server for the lab.

A visual representation of the topology:

![unnamed](https://github.com/user-attachments/assets/7bdaedaa-5a3e-4d51-bde5-072e88a7f178)
